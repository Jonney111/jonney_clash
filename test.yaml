mode: rule
# ipv6 æ”¯æŒ
ipv6: false
log-level: info
# å…è®¸å±€åŸŸç½‘è¿æ¥
allow-lan: true
# socks5/http ç«¯å£
mixed-port: 7890
# Meta å†…æ ¸ç‰¹æ€§ https://wiki.metacubex.one/config/general
# ç»Ÿä¸€å»¶è¿Ÿ
# æ›´æ¢å»¶è¿Ÿè®¡ç®—æ–¹å¼,å»é™¤æ¡æ‰‹ç­‰é¢å¤–å»¶è¿Ÿ
unified-delay: true
# TCP å¹¶å‘
# åŒæ—¶å¯¹æ‰€æœ‰ipè¿›è¡Œè¿æ¥ï¼Œè¿”å›å»¶è¿Ÿæœ€ä½çš„åœ°å€
tcp-concurrent: true
# å¤–éƒ¨æ§åˆ¶ç«¯å£
external-controller: :9090

geodata-mode: true

geox-url:                           # è‡ªå®šä¹‰ geodata url, éœ€è¦æœ‰ä»£ç†çš„å‰ææ‰èƒ½ä¸‹è½½geoipå’Œgeosite
    geoip: "https://gcore.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.dat"
    geosite: "https://gcore.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geosite.dat"
    mmdb: "https://gcore.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/country.mmdb"

# è¿›ç¨‹åŒ¹é…æ¨¡å¼
# è·¯ç”±å™¨ä¸Šè¯·è®¾ç½®ä¸º off
# always å¼€å¯ï¼Œå¼ºåˆ¶åŒ¹é…æ‰€æœ‰è¿›ç¨‹
# strict é»˜è®¤ï¼Œç”± Clash åˆ¤æ–­æ˜¯å¦å¼€å¯
# off ä¸åŒ¹é…è¿›ç¨‹ï¼Œæ¨èåœ¨è·¯ç”±å™¨ä¸Šä½¿ç”¨æ­¤æ¨¡å¼
find-process-mode: strict

# ç¼“è§£ç§»åŠ¨è®¾å¤‡è€—ç”µé—®é¢˜
# https://github.com/vernesong/OpenClash/issues/2614
keep-alive-interval: 1800

# å…¨å±€å®¢æˆ·ç«¯æŒ‡çº¹
global-client-fingerprint: random # éšæœºæŒ‡çº¹

# ç¼“å­˜
profile:
    store-selected: true          # å­˜å‚¨ select é€‰æ‹©è®°å½•
    store-fake-ip: true           # æŒä¹…åŒ– fake-ip

# è‡ªåŠ¨åŒæ­¥æ—¶é—´ä»¥é˜²æ­¢æ—¶é—´ä¸å‡†å¯¼è‡´æ— æ³•æ­£å¸¸è”ç½‘
ntp:
    enable: true
    # æ˜¯å¦åŒæ­¥è‡³ç³»ç»Ÿæ—¶é—´ï¼Œéœ€è¦ root/ç®¡ç†å‘˜æƒé™
    write-to-system: false
    server: time.windows.com
    port: 123
    interval: 30

# åŸŸåå—…æ¢
sniffer:
    enable: true
    sniff:
      TLS:
        ports: [443, 8443]
      HTTP:
        ports: [80, 8080-8880]
        override-destination: true
      QUIC:
        ports: [443, 8443]        

# tun æ¨¡å¼
tun:
    enable: true                    #PCç«¯å¼€å¯ è·¯ç”±å™¨ä¸å¼€å¯
    stack: system                   # gvisor / lwip                    
    dns-hijack:                      # éœ€è¦åŠ«æŒçš„ DNS
        - "any:53"
    auto-route: true                 # è‡ªåŠ¨è®¾ç½®å…¨å±€è·¯ç”±ï¼Œå¯ä»¥è‡ªåŠ¨å°†å…¨å±€æµé‡è·¯ç”±è¿›å…¥tunç½‘å¡
    auto-detect-interface: true      # è‡ªåŠ¨è¯†åˆ«å‡ºå£ç½‘å¡

# dns è®¾ç½®
# å·²é…ç½® ipv6
dns:
    enable: true
    listen: :1053
    ipv6: false
    # è·¯ç”±å™¨ä¸ªäººå»ºè®®ä½¿ç”¨ redir-host ä»¥æœ€ä½³å…¼å®¹æ€§
    # å…¶ä»–è®¾å¤‡å¯ä»¥ä½¿ç”¨ fake-ip
    enhanced-mode: fake-ip
    fake-ip-range: 198.18.0.1/16
    default-nameserver:
        - 223.5.5.5
        - 119.29.29.29
        - 114.114.114.114
    nameserver:
        - https://doh.pub/dns-query
        - https://dns.alidns.com/dns-query
    proxy-server-nameserver:
        - https://doh.pub/dns-query
    nameserver-policy:
        "geosite:cn,private":
           - https://doh.pub/dns-query
           - https://dns.alidns.com/dns-query
        "geosite:geolocation-!cn":
           - "https://dns.cloudflare.com/dns-query#dns"
           - "https://dns.google/dns-query#dns"
#èŠ‚ç‚¹å­˜æ”¾åœ°å€
proxies:

#ä»£ç†é›†  å¦‚æœæ˜¯è‡ªå»ºèŠ‚ç‚¹å±è”½è¿™é‡Œ
use: &use
    type: select
    use:
       - ä»£ç†  
proxy-providers:
    #è‡ªå®šä¹‰æœºåœºåç§°subscribe_groups
    ä»£ç†:
        type: http # http çš„ path å¯ç©ºç½®,é»˜è®¤å‚¨å­˜è·¯å¾„ä¸º homedirçš„proxiesæ–‡ä»¶å¤¹,æ–‡ä»¶åä¸ºurlçš„md5
        url: "" #è®¢é˜…é“¾æ¥å­˜æ”¾åœ¨åŒå¼•å·å†…
        interval: 86400 #æœºåœºè®¢é˜…è‡ªåŠ¨æ›´æ–°æ—¶é—´ å•ä½ï¼šç§’
        path: ./rule_provider/paolu.yaml # é»˜è®¤åªå…è®¸å­˜å‚¨åœ¨ clash çš„ Home Dirï¼Œå¦‚æœæƒ³å­˜å‚¨åˆ°ä»»æ„ä½ç½®ï¼Œæ·»åŠ ç¯å¢ƒå˜é‡ SKIP_SAFE_PATH_CHECK=1
        health-check:
            enable: true
            interval: 300
            # lazy: true
            url: https://www.gstatic.com/generate_204
        override:
            skip-cert-verify: true  
            udp: true
        filter: "^((?!æ›´æ–°|å‰©ä½™|æµé‡|æç¤º|å®˜ç½‘).)*$"   


#ä»£ç†ç»„
proxy-groups:    
#ğŸ“ºbilibili
    - name: "ğŸ“ºBilibili"
      proxies:
      - DIRECT
      <<: *use 
      filter: ^(?!.*GAME).*(é¦™æ¸¯|HK|Hong Kong|TW|å°|å°æ¹¾).*$
#ğŸ‘€Twitch
    - name: "ğŸ‘€Twitch"
      proxies:
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      <<: *use 
      filter: "^(?!.*GAME).*(é¦™æ¸¯|HK|Hong Kong|TW|å°|å°æ¹¾).*$"
#ğŸï¸åŠ¨ç”»ç–¯
    - name: "ğŸï¸åŠ¨ç”»ç–¯"
      <<: *use 
      filter: "TW|å°æ¹¾"
#ğŸ”¥OpenAI
    - name: "ğŸ”¥OpenAI"
      <<: *use 
      filter: "æ–°åŠ å¡|SG|ç‹®åŸ|JP|æ—¥æœ¬|ç¾|ç¾å›½|USA"  
#ğŸApple
    - name: "ğŸApple"
      proxies:
      - DIRECT
      <<: *use 
      filter: "^(?!.*GAME).*(é¦™æ¸¯|HK||TW|å°æ¹¾|æ—¥æœ¬|ç¾å›½).*$"
#ğŸ¥Youtube
    - name: "ğŸ¥Youtube"
      proxies:
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      <<: *use 
      filter: "^(?!.*GAME).*(é¦™æ¸¯|HK|Hong Kong|TW|å°æ¹¾|JP|æ—¥æœ¬|ç¾å›½|USA).*$"
#ğŸ®æ¸¸æˆå¹³å°
    - name: "ğŸ®æ¸¸æˆå¹³å°"
      proxies:
      - DIRECT
      <<: *use 
      filter: "^(?!.*GAME).*(é¦™æ¸¯|å°æ¹¾|é˜¿æ ¹å»·|æ–°åŠ å¡|æ—¥æœ¬|ç¾å›½).*$"
#ğŸ®ğŸ•¹ï¸æ¸¸æˆåŠ é€Ÿ
    - name: "ğŸ•¹ï¸æ¸¸æˆåŠ é€Ÿ"
      proxies:
      - DIRECT
      <<: *use 
      filter: "GAME|æ¸¸æˆ|game|é¦™æ¸¯" 
#ğŸ®ğŸ¬Netflix
    - name: "ğŸ¬Netflix"
      proxies:
      - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
      <<: *use 
      filter: "TW|å°|å°æ¹¾|æ–°åŠ å¡|SG|ç‹®åŸ|ç¾|ç¾å›½|USA|JP|æ—¥æœ¬"   
#ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    - name: "ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹"
      type: url-test
      use:
          - ä»£ç†
      url: 'https://www.gstatic.com/generate_204'
      interval: 300
      tolerance: 50
      filter: "^(?!.*GAME).*(é¦™æ¸¯|HK|Hong Kong).*$" 
#ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
    - name: "ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹"
      type: fallback
      use:
          - ä»£ç†
      url: 'https://www.gstatic.com/generate_204'
      interval: 300
      filter: "sg|æ–°åŠ å¡"
#âœˆï¸æœºåœºé…ç½®
    - name: "âœˆï¸æœºåœºé…ç½®"
      proxies:
      - DIRECT
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
      <<: *use 
      
#è§„åˆ™é›†
rule-providers:           
    applications:
        type: http
        behavior: classical
        interval: 86400
        path: ./ruleset/applications.yaml
        url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/applications.txt"  
    OpenAI:      
        type: http
        behavior: classical
        interval: 86400
        path: ./ruleset/OpenAI.yaml
        url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/OpenAI/OpenAI_No_Resolve.yaml"
    BardAI:      
        type: http
        behavior: classical
        interval: 86400
        path: ./ruleset/BardAI.yaml
        url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/BardAI/BardAI.yaml"
# anti-AD å¹¿å‘Šæ‹¦æˆªè§„åˆ™
# https://github.com/privacy-protection-tools/anti-AD
# å¦‚æœè¯¯æ€ç‡é«˜è¯·è‡ªè¡Œæ›´æ¢
#    anti-AD:
#      type: http
#      behavior: domain
#      format: yaml
# pathå¯ä¸ºç©º(ä»…é™clash.meta 1.15.0ä»¥ä¸Šç‰ˆæœ¬)
#      path: ./rule_provider/anti-AD.yaml
#      url: "https://raw.githubusercontent.com/privacy-protection-tools/anti-AD/master/anti-ad-clash.yaml?"
#      interval: 600
# anti-AD ç™½åå•è§„åˆ™
#    anti-AD-white:
#      type: http
#      behavior: domain
#      format: yaml
# pathå¯ä¸ºç©º(ä»…é™clash.meta 1.15.0ä»¥ä¸Šç‰ˆæœ¬)
#      path: ./rule_provider/anti-AD-white.yaml
#      url: "https://raw.githubusercontent.com/privacy-protection-tools/dead-horse/master/anti-ad-white-for-clash.yaml?"
#      interval: 600
rules:
#åŸŸåè§„åˆ™
  # è‹¥éœ€ç¦ç”¨ QUIC è¯·å–æ¶ˆæ³¨é‡Š QUIC ä¸¤æ¡è§„åˆ™
  # é˜²æ­¢ YouTube ç­‰ä½¿ç”¨ QUIC å¯¼è‡´é€Ÿåº¦ä¸ä½³, ç¦ç”¨ 443 ç«¯å£ UDP æµé‡ï¼ˆä¸åŒ…æ‹¬å›½å†…ï¼‰
  # - AND,(AND,(DST-PORT,443),(NETWORK,UDP)),(NOT,((GEOSITE,cn))),REJECT # quic
  # - AND,(AND,(DST-PORT,443),(NETWORK,UDP)),(NOT,((GEOIP,CN))),REJECT # quic
  # - AND,((RULE-SET,anti-AD),(NOT,((RULE-SET,anti-AD-white)))),å¹¿å‘Šæ‹¦æˆª
    - RULE-SET,applications,DIRECT
    - GEOSITE,microsoft@cn,DIRECT 
    - GEOSITE,steam@cn,DIRECT
    - GEOSITE,category-games@cn,DIRECT 
#åœ¨è¿™é‡Œæ·»åŠ è‡ªå®šä¹‰ç›´è¿è§„åˆ™
    - DOMAIN,xn--ngstr-lra8j.com,âœˆï¸æœºåœºé…ç½®
    - DOMAIN,services.googleapis.cn,âœˆï¸æœºåœºé…ç½®
    - DOMAIN,mtalk.google.com,âœˆï¸æœºåœºé…ç½®
    - DOMAIN-SUFFIX,voidsec.com,âœˆï¸æœºåœºé…ç½®   #voidsec ç¤¼è²Œæ€§æ·»åŠ æ‰€è°“çš„dnsæ³„éœ²æ£€æµ‹ç«™
    - DOMAIN-SUFFIX,browserleaks.com,âœˆï¸æœºåœºé…ç½® #browserleaks ç¤¼è²Œæ€§æ·»åŠ æ‰€è°“çš„dnsæ³„éœ²æ£€æµ‹ç«™
    - DOMAIN-SUFFIX,ipleak.net,âœˆï¸æœºåœºé…ç½® #ipleak ç¤¼è²Œæ€§æ·»åŠ æ‰€è°“çš„dnsæ³„éœ²æ£€æµ‹ç«™
#è‡ªå®šä¹‰åŸŸåè§„åˆ™
    - GEOSITE,bilibili,ğŸ“ºBilibili
    - GEOSITE,twitch,ğŸ‘€Twitch
    - GEOSITE,bahamut,ğŸï¸åŠ¨ç”»ç–¯
    - RULE-SET,OpenAI,ğŸ”¥OpenAI
    - RULE-SET,BardAI,ğŸ”¥OpenAI
    - GEOSITE,apple,ğŸApple
    - GEOSITE,apple-cn,ğŸApple
    - GEOSITE,youtube,ğŸ¥Youtube
    - GEOSITE,blizzard,ğŸ®æ¸¸æˆå¹³å°
    - GEOSITE,steam,ğŸ®æ¸¸æˆå¹³å°
    - GEOSITE,xbox,ğŸ®æ¸¸æˆå¹³å°
    - GEOSITE,netflix,ğŸ¬Netflix
    - GEOSITE,telegram,âœˆï¸æœºåœºé…ç½®
    - GEOSITE,twitter,âœˆï¸æœºåœºé…ç½®
    - GEOSITE,google,âœˆï¸æœºåœºé…ç½®
    - GEOSITE,google-cn,âœˆï¸æœºåœºé…ç½®   # Google CN ä¸èµ°ä»£ç†ä¼šå¯¼è‡´é¦™æ¸¯ç­‰åœ°åŒºèŠ‚ç‚¹ Play Store å¼‚å¸¸
    - GEOSITE,CN,DIRECT    
#IPè§„åˆ™
    - GEOIP,lan,DIRECT,no-resolve
    - GEOIP,PRIVATE,DIRECT,no-resolve
    - GEOIP,netflix,ğŸ¬Netflix
    - GEOIP,telegram,âœˆï¸æœºåœºé…ç½®
    - GEOIP,twitter,âœˆï¸æœºåœºé…ç½®
    - GEOIP,google,âœˆï¸æœºåœºé…ç½®
    - GEOIP,CN,DIRECT
#æœ€ç»ˆåŒ¹é… ç™½åå•æ¨¡å¼
    - MATCH,âœˆï¸æœºåœºé…ç½®   
